
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Some thoughts on the design of friendly-traceback &#8212; Friendly tracebacks 0.0.2 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Bienvenue 환영합니다 Bienvenido - ようこそ Welcome 歡迎光臨" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="Bienvenue 환영합니다 Bienvenido - ようこそ Welcome 歡迎光臨"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Friendly tracebacks 0.0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Some thoughts on the design of friendly-traceback</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic usage</a></li>
<li><a class="reference internal" href="#localization">Localization</a></li>
<li><a class="reference internal" href="#verbosity">Verbosity</a><ul>
<li><a class="reference internal" href="#basic">1. Basic</a></li>
<li><a class="reference internal" href="#intermediate">2. Intermediate</a></li>
<li><a class="reference internal" href="#advanced">3. Advanced</a></li>
<li><a class="reference internal" href="#setting-the-verbosity-level">Setting the verbosity level</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extensibility">Extensibility</a></li>
<li><a class="reference internal" href="#about-the-likely-cause">About the likely cause</a></li>
<li><a class="reference internal" href="#additional-configuration">Additional configuration</a></li>
<li><a class="reference internal" href="#other-similar-projects">Other similar projects</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Bienvenue 환영합니다 Bienvenido - ようこそ Welcome  歡迎光臨</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/design.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="some-thoughts-on-the-design-of-friendly-traceback">
<h1>Some thoughts on the design of friendly-traceback<a class="headerlink" href="#some-thoughts-on-the-design-of-friendly-traceback" title="Permalink to this headline">¶</a></h1>
<p>The following are thoughts on the design of this project.
The content of this file <strong>will</strong> be changed as this project evolve.
However, it is likely that experimentations with features will
proceed faster and in slightly different ways than the content
of this page would suggest.</p>
<div class="section" id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>There should be three ways of using friendly-traceback.</p>
<ol class="arabic">
<li><p class="first">As an import hook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">friendly_traceback</span>
<span class="n">friendly_traceback</span><span class="o">.</span><span class="n">install</span><span class="p">()</span>  <span class="c1"># sys.excepthook = friendly_traceback.explain</span>
</pre></div>
</div>
</li>
<li><p class="first">Catching exceptions locally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="c1"># Some code</span>
<span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
    <span class="n">friendly_traceback</span><span class="o">.</span><span class="n">explain</span><span class="p">(</span><span class="o">*</span><span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">())</span>
</pre></div>
</div>
</li>
<li><p class="first">When launching a Python script (or the REPL):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">friendly_traceback</span> <span class="n">myscript</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</li>
</ol>
<p>By default, friendly tracebacks will be written to sys.stderr.
However, it should be possible to override this choice.</p>
</div>
<div class="section" id="localization">
<h2>Localization<a class="headerlink" href="#localization" title="Permalink to this headline">¶</a></h2>
<p>It should be possible to translate almost all the text provided.
Some exceptions and examples will be given below.</p>
<p>The determination of which language is used to provide translations
is normally determined by using Python’s <code class="docutils literal notranslate"><span class="pre">locale.getdefaultlocale()</span></code>.
However, it can be over-ridden in the following way, in order
of precedence:</p>
<ol class="arabic simple">
<li>Using <code class="docutils literal notranslate"><span class="pre">friendly_traceback.set_lang(lang)</span></code></li>
<li>Using the environment variable <code class="docutils literal notranslate"><span class="pre">os.environ['FriendlyTracebackLang']</span></code></li>
<li>Using variables found in a <code class="docutils literal notranslate"><span class="pre">.friendly_traceback.ini</span></code> file</li>
</ol>
</div>
<div class="section" id="verbosity">
<h2>Verbosity<a class="headerlink" href="#verbosity" title="Permalink to this headline">¶</a></h2>
<p>There should be different levels of verbosity.</p>
<div class="section" id="basic">
<h3>1. Basic<a class="headerlink" href="#basic" title="Permalink to this headline">¶</a></h3>
<p>A basic level would include four parts:</p>
<blockquote>
<div><ol class="arabic simple">
<li>A single line, introduced by <em>Python Exception:</em> showing the <strong>untranslated</strong> information from Python</li>
<li>A section explaining what is normally meant by a given Exception</li>
<li>A section showing the likely cause of the error.</li>
</ol>
</div></blockquote>
<p>For example, in English:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Python</span> <span class="n">exception</span><span class="p">:</span>
    <span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;c&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>

<span class="n">Error</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">file</span> <span class="s1">&#39;filename.py&#39;</span> <span class="n">on</span> <span class="n">line</span> <span class="mf">4.</span>

   <span class="mi">3</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">--&gt;</span><span class="mi">4</span><span class="p">:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
   <span class="mi">5</span><span class="p">:</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">A</span> <span class="ne">NameError</span> <span class="n">exception</span> <span class="n">indicates</span> <span class="n">that</span> <span class="n">a</span> <span class="n">variable</span> <span class="ow">or</span>
<span class="n">function</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">known</span> <span class="n">to</span> <span class="n">Python</span><span class="o">.</span>
<span class="n">Most</span> <span class="n">often</span><span class="p">,</span> <span class="n">this</span> <span class="ow">is</span> <span class="n">because</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">spelling</span> <span class="n">mistake</span><span class="p">;</span>
<span class="n">however</span><span class="p">,</span> <span class="n">sometimes</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">because</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">used</span>
<span class="n">before</span> <span class="n">being</span> <span class="n">defined</span> <span class="ow">or</span> <span class="n">given</span> <span class="n">a</span> <span class="n">value</span><span class="o">.</span>

<span class="n">Likely</span> <span class="n">cause</span><span class="p">:</span>
    <span class="n">In</span> <span class="n">your</span> <span class="n">program</span><span class="p">,</span> <span class="n">the</span> <span class="n">unknown</span> <span class="n">name</span> <span class="ow">is</span> <span class="s1">&#39;c&#39;</span><span class="o">.</span>
</pre></div>
</div>
<p>The corresponding French version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Exception</span> <span class="n">Python</span><span class="p">:</span>
    <span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;c&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>

<span class="n">Erreur</span> <span class="n">trouvée</span> <span class="n">dans</span> <span class="n">le</span> <span class="n">fichier</span> <span class="s1">&#39;filename.py&#39;</span> <span class="n">à</span> <span class="n">la</span> <span class="n">ligne</span> <span class="mf">4.</span>

   <span class="mi">3</span><span class="p">:</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">--&gt;</span><span class="mi">4</span><span class="p">:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span>
   <span class="mi">5</span><span class="p">:</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">Une</span> <span class="n">exception</span> <span class="n">de</span> <span class="nb">type</span> <span class="ne">NameError</span> <span class="n">indique</span> <span class="n">que</span> <span class="n">le</span> <span class="n">nom</span> <span class="n">d</span><span class="s1">&#39;une variable</span>
<span class="n">ou</span> <span class="n">d</span><span class="s1">&#39;une fonction utilisée dans votre programme est inconnu par Python.</span>
<span class="n">Le</span> <span class="n">plus</span> <span class="n">souvent</span><span class="p">,</span> <span class="n">ceci</span> <span class="n">se</span> <span class="n">produit</span> <span class="n">parce</span> <span class="n">que</span> <span class="n">vous</span> <span class="n">faites</span> <span class="n">une</span> <span class="n">faute</span>
<span class="n">d</span><span class="s1">&#39;orthographe dans l&#39;</span><span class="n">écriture</span> <span class="n">de</span> <span class="n">votre</span> <span class="n">variable</span> <span class="n">ou</span> <span class="n">de</span> <span class="n">votre</span> <span class="n">fonction</span><span class="p">;</span>
<span class="n">ceci</span> <span class="n">peut</span> <span class="n">également</span> <span class="n">se</span> <span class="n">produire</span> <span class="n">si</span> <span class="n">vous</span> <span class="n">invoquez</span> <span class="n">cette</span> <span class="n">fonction</span> <span class="n">ou</span> <span class="n">utilisez</span>
<span class="n">cette</span> <span class="n">variable</span> <span class="n">sans</span> <span class="n">l</span><span class="s1">&#39;avoir définie auparavant.</span>

<span class="n">Cause</span> <span class="n">probable</span><span class="p">:</span>
    <span class="n">Dans</span> <span class="n">votre</span> <span class="n">programme</span><span class="p">,</span> <span class="n">le</span> <span class="n">nom</span> <span class="n">inconnu</span> <span class="n">est</span> <span class="s1">&#39;c&#39;</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="intermediate">
<h3>2. Intermediate<a class="headerlink" href="#intermediate" title="Permalink to this headline">¶</a></h3>
<p>In addition to the basic version, an intermediate version might also
include some additional information about known local and global variables
and their values, similar to what is provided by
<a class="reference external" href="https://github.com/albertz/py_better_exchook">https://github.com/albertz/py_better_exchook</a></p>
</div>
<div class="section" id="advanced">
<h3>3. Advanced<a class="headerlink" href="#advanced" title="Permalink to this headline">¶</a></h3>
<p>In addition to what would be provided by the intermediate version,
the advanced version would have the normal Python traceback appended at the end.</p>
</div>
<div class="section" id="setting-the-verbosity-level">
<h3>Setting the verbosity level<a class="headerlink" href="#setting-the-verbosity-level" title="Permalink to this headline">¶</a></h3>
<p>This could be done when using <code class="docutils literal notranslate"><span class="pre">friendly_traceback</span></code> explicitly in the
program, as an option in the calling function.</p>
<p>If no such option is provided, then it should be set either from
the local environment variables (as for the language) or from a global
<code class="docutils literal notranslate"><span class="pre">.ini</span></code> file.</p>
</div>
</div>
<div class="section" id="extensibility">
<h2>Extensibility<a class="headerlink" href="#extensibility" title="Permalink to this headline">¶</a></h2>
<p>For projects that have their custom Exceptions, like AvantPy, it should
be possible to add the custom exceptions to those handled by
friendly-traceback.  Perhaps with something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">friendly_traceback</span> <span class="k">as</span> <span class="nn">friendly</span>
<span class="kn">from</span> <span class="nn">my_project</span> <span class="k">import</span> <span class="n">my_exceptions</span>

<span class="n">friendly</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">my_exceptions</span><span class="p">)</span>
<span class="n">friendly</span><span class="o">.</span><span class="n">install</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="about-the-likely-cause">
<h2>About the likely cause<a class="headerlink" href="#about-the-likely-cause" title="Permalink to this headline">¶</a></h2>
<p>For some exceptions, such as NameError, it might be easy to find the
original cause and report it in a way that is easy to understand
as shown in the example above. However, that might not be the case
for SyntaxError.  These could normally be found by using pylint
or flake8 before running the code. It should be possible to either
use one of these packages to do this analysis when an error is found,
or to develop a simplified version that focuses on Syntax Errors,
and is designed from the start to provide localized (i.e. translated)
information.</p>
</div>
<div class="section" id="additional-configuration">
<h2>Additional configuration<a class="headerlink" href="#additional-configuration" title="Permalink to this headline">¶</a></h2>
<p>It should be possible to add some colours to various parts of the
traceback information; however, this should likely be done only</p>
<ol class="arabic simple">
<li>if friendly_traceback is embedded in another application which has
full control over its display (some terminal emulators might not
support control characters required for colours - or do so in
a way that might be counter productive)</li>
<li>Based on values found in a <code class="docutils literal notranslate"><span class="pre">.ini</span></code> file.</li>
</ol>
<p>This additional feature should only be implemented after all other
issues have been dealt with.</p>
</div>
<div class="section" id="other-similar-projects">
<h2>Other similar projects<a class="headerlink" href="#other-similar-projects" title="Permalink to this headline">¶</a></h2>
<p>Many other projects do some enhanced traceback formatting, however
none that we know of aim at</p>
<ol class="arabic simple">
<li>making tracebacks easier to understand by beginners</li>
<li>translating traceback information.</li>
</ol>
<p>Still, there is much to learn by looking at what others are doing.
The following is an incomplete list of projects or modules to look at:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/3/library/cgitb.html">https://docs.python.org/3/library/cgitb.html</a></li>
<li><a class="reference external" href="https://github.com/albertz/py_better_exchook/">https://github.com/albertz/py_better_exchook/</a></li>
<li><a class="reference external" href="https://github.com/Infinidat/infi.traceback">https://github.com/Infinidat/infi.traceback</a></li>
<li><a class="reference external" href="https://github.com/laurb9/rich-traceback">https://github.com/laurb9/rich-traceback</a></li>
<li><a class="reference external" href="http://www.wotevah.com/code/log.py">http://www.wotevah.com/code/log.py</a></li>
<li><a class="reference external" href="https://github.com/ipython/ipython/blob/master/IPython/core/ultratb.py">https://github.com/ipython/ipython/blob/master/IPython/core/ultratb.py</a></li>
<li><a class="reference external" href="https://github.com/patrys/great-justice">https://github.com/patrys/great-justice</a></li>
<li><a class="reference external" href="https://github.com/Qix-/better-exceptions">https://github.com/Qix-/better-exceptions</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="Bienvenue 환영합니다 Bienvenido - ようこそ Welcome 歡迎光臨"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Friendly tracebacks 0.0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, André Roberge.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>